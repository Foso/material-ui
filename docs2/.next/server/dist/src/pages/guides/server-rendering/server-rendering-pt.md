module.exports = "# Renderização no servidor\n\n<p class=\"description\">O caso de uso mais comum para a renderização do lado do servidor, é manipular a renderização inicial quando um usuário (ou rastreador do mecanismo de pesquisa) solicita sua aplicação.</p>\n\nQuando o servidor recebe a solicitação, ele renderiza o componente(s) requerido em uma cadeia HTML e o envia como uma resposta ao cliente. A partir desse momento, o cliente assume as funções de renderização.\n\n## Material-UI no servidor\n\nO Material-UI foi desenhado da base com as limitações de renderizar no servidor, mas você pode se certificar que será integrado corretamente. É importante fornecer a página com o CSS necessário, caso contrário a página irá renderizar somente o HTML até o CSS ser injetado pelo cliente, causando uma tremulação (FOUC). Para injetar o estilo no cliente, precisamos:\n\n1. Cria uma instância nova e fresca do [`ServerStyleSheets`](/styles/api/#serverstylesheets) em cada requisição.\n2. Renderize a árvore React com o coletor do lado do servidor.\n3. Puxe o CSS para fora.\n4. Passe o CSS junto ao cliente.\n\nNo lado do cliente, o CSS será injetado uma segunda vez antes de remover o CSS injetado no lado do servidor.\n\n## Configurando\n\nNa receita a seguir, vamos ver como configurar a renderização do lado do servidor.\n\n### O tema\n\nCreate a theme that will be shared between the client and the server:\n\n`theme.js`\n\n```js\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport red from '@material-ui/core/colors/red';\n\n// Cria a instância do tema.\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#556cd6',\n    },\n    secondary: {\n      main: '#19857b',\n    },\n    error: {\n      main: red.A400,\n    },\n    background: {\n      default: '#fff',\n    },\n  },\n});\n\nexport default theme;\n```\n\n### O lado do servidor\n\nThe following is the outline for what the server-side is going to look like. We are going to set up an [Express middleware](https://expressjs.com/en/guide/using-middleware.html) using [app.use](https://expressjs.com/en/api.html) to handle all requests that come in to the server. If you're unfamiliar with Express or middleware, just know that the handleRender function will be called every time the server receives a request.\n\n`server.js`\n\n```js\nimport express from 'express';\n\n// Vamos preenchê-las nas seções a seguir.\nfunction renderFullPage(html, css) {\n  /* ... */\n}\n\nfunction handleRender(req, res) {\n  /* ... */\n}\n\nconst app = express();\n\n// Isso é acionado toda vez que o servidor recebe uma solicitação.\napp.use(handleRender);\n\nconst port = 3000;\napp.listen(port);\n```\n\n### Manipulando a requisição\n\nA primeira coisa que precisamos fazer em cada solicitação é criar um novo `ServerStyleSheets`.\n\nWhen rendering, we will wrap `App`, the root component, inside a [`StylesProvider`](/styles/api/#stylesprovider) and [`ThemeProvider`](/styles/api/#themeprovider) to make the style configuration and the `theme` available to all components in the component tree.\n\nThe key step in server-side rendering is to render the initial HTML of the component **before** we send it to the client side. Para fazer isso, usamos [ReactDOMServer.renderToString()](https://reactjs.org/docs/react-dom-server.html).\n\nWe then get the CSS from the `sheets` using `sheets.toString()`. We will see how this is passed along in the `renderFullPage` function.\n\n```jsx\nimport express from 'express';\nimport React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport { ServerStyleSheets, ThemeProvider } from '@material-ui/core/styles';\nimport App from './App';\nimport theme from './theme';\n\nfunction handleRender(req, res) {\n  const sheets = new ServerStyleSheets();\n\n  // Render the component to a string.\n  const html = ReactDOMServer.renderToString(\n    sheets.collect(\n      <ThemeProvider theme={theme}>\n        <App />\n      </ThemeProvider>,\n    ),\n  );\n\n  // Grab the CSS from the sheets.\n  const css = sheets.toString();\n\n  // Envia a página renderizada de volta ao cliente.\n  res.send(renderFullPage(html, css));\n}\n\nconst app = express();\n\napp.use('/build', express.static('build'));\n\n// Isso é acionado toda vez que o servidor recebe uma solicitação.\napp.use(handleRender);\n\nconst port = 3000;\napp.listen(port);\n```\n\n### Injetar Componente Inicial HTML e CSS\n\nThe final step on the server-side is to inject the initial component HTML and CSS into a template to be rendered on the client side.\n\n```js\nfunction renderFullPage(html, css) {\n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <title>Minha página</title>\n        <style id=\"jss-server-side\">${css}</style>\n      </head>\n      <body>\n        <div id=\"root\">${html}</div>\n      </body>\n    </html>\n  `;\n}\n```\n\n### O lado do cliente\n\nO lado do cliente é direto. Tudo o que precisamos fazer é remover o CSS gerado no lado do servidor. Let's take a look at the client file:\n\n`client.js`\n\n```jsx\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport App from './App';\nimport theme from './theme';\n\nfunction Main() {\n  React.useEffect(() => {\n    const jssStyles = document.querySelector('#jss-server-side');\n    if (jssStyles) {\n      jssStyles.parentElement.removeChild(jssStyles);\n    }\n  }, []);\n\n  return (\n    <ThemeProvider theme={theme}>\n      <App />\n    </ThemeProvider>\n  );\n}\n\nReactDOM.hydrate(<Main />, document.querySelector('#root'));\n```\n\n## Implementações de referência\n\nNós hospedamos diferentes implementações de referência que você pode encontrar no [repositório GitHub](https://github.com/Foso/material-ui) sob a pasta o [`/examples`](https://github.com/Foso/material-ui/tree/master/examples):\n\n- [A implementação de referência deste tutorial](https://github.com/Foso/material-ui/tree/master/examples/ssr)\n- [Gatsby](https://github.com/Foso/material-ui/tree/master/examples/gatsby)\n- [Next.js](https://github.com/Foso/material-ui/tree/master/examples/nextjs)\n\n## Resolução de problemas\n\nCheck out the FAQ answer: [My App doesn't render correctly on the server](/getting-started/faq/#my-app-doesnt-render-correctly-on-the-server).\n"