module.exports = "# 从v3版本迁移到v4版本\n\n<p class=\"description\">是的，我们已经发布了v4版本！</p>\n\n您在找v3版本的文档吗？ [您可以在这里找到它们](https://material-ui.com/versions/) 。\n\n> 此文档尚未完成。 您是否已经升级了站点并且遇到了一些并没有在此涉及的问题？ [请在 GitHub 添加您的更改](https://github.com/Foso/material-ui/blob/master/docs/src/pages/guides/migration-v3/migration-v3.md)。\n\n## 简介\n\n当您将站点从 Material-UI 的v3版本升级到v4版本时，此篇会给您提供一些参考。 您可能不会将这里所有覆盖的内容运用到你的站点上。 我们会尽我们最大的努力让文档简单易懂，并尽可能有序地介绍，这样您可以迅速对v4版本游刃有余。\n\n## 为什么您需要迁移\n\n此文档介绍了*h如何*从v3版本迁移到v4版本。 关于迁移的*原因*，我们则在 [Medium上发布了一篇博客](https://medium.com/material-ui/material-ui-v4-is-out-4b7587d1e701)来详细解说。\n\n## 更新您的依赖包\n\n您需要做的第一件事，就是更新您的依赖包。\n\n### 升级 Material-UI 的版本\n\n若想要使用最新版本的 Material-UI，您必须更新 `package.json`。\n\n```json\n\"dependencies\": {\n  \"@material-ui/core\": \"^4.0.0\"\n}\n```\n\n或者运行\n\n```sh\nnpm install @material-ui/core\n\n或者\n\nyarn add @material-ui/core\n```\n\n### 更新 React 的版本\n\n对于 React 版本的最低要求是从 `react@^16.3.0` 升级到 `react@^16.8.0`。 这样一来我们能够依赖 [Hooks](https://reactjs.org/docs/hooks-intro.html) 的功能（我们已经不再使用 class API）。\n\n### 更新 Material-UI Styles 的版本\n\n若您以前使用v3版本的 `@material-ui/styles`，您则需要更新 `package.json`，这样才能使用最新版本的 Material-UI Styles。\n\n```json\n\"dependencies\": {\n  \"@material-ui/styles\": \"^4.0.0\"\n}\n```\n\n或者运行\n\n```sh\nnpm install @material-ui/styles\n\n或者\n\nyarn add @material-ui/styles\n```\n\n## 处理变化带来的系统崩溃\n\n### Core\n\n- 每个组件会提供他们的 ref。 这是通过使用 `React.forwardRef()` 实现的。 这回影响到内部的组件树和显示的名称，进而会使得 shallow 或者 snapshot 测试崩溃。 `innerRef` 不再返回一个实例的 ref（或者当内部组件是一个函数组件时，什么都不返回），而是返回一个它根组件的 ref。 相应的 API 文档在根组件中列出了。\n\n### Styles（样式表单）\n\n- ⚠️ Material-UI 依赖于 JSS v10版本。 JSS v10版本与v9版本不向后兼容。 请保证您的开发环境中未安装 JSS v9版本。 (Removing `react-jss` from your `package.json` can help). StylesProvider 组件替代了 JssProvider 组件。\n- 请移除 `withTheme()` 中的第一个可选的参数。 (The first argument was a placeholder for a potential future option that never arose.)\n  \n    它与[emotion 的 API](https://emotion.sh/docs/introduction) 以及 [styled-components 的 API ](https://www.styled-components.com) 相匹配。\n\n```diff\n  -const DeepChild = withTheme()(DeepChildRaw);\n  +const DeepChild = withTheme(DeepChildRaw);\n  ```\n\n- Rename `convertHexToRGB` to `hexToRgb`.\n\n  ```diff\n  -import { convertHexToRgb } from '@material-ui/core/styles/colorManipulator';\n  +import { hexToRgb } from '@material-ui/core/styles';\n  ```\n\n- Scope the [keyframes API](https://cssinjs.org/jss-syntax/#keyframes-animation). You should apply the following changes in your codebase.\n  It helps isolating the animation logic:\n\n  ```diff\n    rippleVisible: {\n      opacity: 0.3,\n  -   animation: 'mui-ripple-enter 100ms cubic-bezier(0.4, 0, 0.2, 1)',\n  +   animation: '$mui-ripple-enter 100ms cubic-bezier(0.4, 0, 0.2, 1)',\n    },\n    '@keyframes mui-ripple-enter': {\n      '0%': {\n        opacity: 0.1,\n      },\n      '100%': {\n        opacity: 0.3,\n      },\n    },\n  ```\n\n### Theme\n\n- The `theme.palette.augmentColor()` method no longer performs a side effect on its input color.\n  To use it correctly, you have to use the returned value.\n\n  ```diff\n  -const background = { main: color };\n  -theme.palette.augmentColor(background);\n  +const background = theme.palette.augmentColor({ main: color });\n\n  console.log({ background });\n  ```\n\n- You can safely remove the next variant from the theme creation:\n\n  ```diff\n  typography: {\n  - useNextVariants: true,\n  },\n  ```\n\n- `theme.spacing.unit` usage is deprecated, you can use the new API:\n\n  ```diff\n  label: {\n    [theme.breakpoints.up('sm')]: {\n  -   paddingTop: theme.spacing.unit * 12,\n  +   paddingTop: theme.spacing(12),\n    },\n  }\n  ```\n\n  *Tip: you can provide more than 1 argument: `theme.spacing(1, 2) // = '8px 16px'`*.\n\n  You can use [the migration helper](https://github.com/Foso/material-ui/tree/master/packages/material-ui-codemod/README.md#theme-spacing-api) on your project to make this smoother.\n\n### Layout\n\n- [Grid] In order to support arbitrary spacing values and to remove the need to mentally count by 8, we are changing the spacing API:\n\n  ```diff\n    /**\n     * Defines the space between the type `item` component.\n     * It can only be used on a type `container` component.\n     */\n  -  spacing: PropTypes.oneOf([0, 8, 16, 24, 32, 40]),\n  +  spacing: PropTypes.oneOf([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]),\n  ```\n  Going forward, you can use the theme to implement [a custom Grid spacing transformation function](https://material-ui.com/system/spacing/#transformation).\n- [Container] Moved from `@material-ui/lab` to `@material-ui/core`.\n\n  ```diff\n  -import Container from '@material-ui/lab/Container';\n  +import Container from '@material-ui/core/Container';\n  ```\n\n### TypeScript\n\n#### `value` type\n\nNormalized `value` prop type for input components to use `unknown`. This affects\n`InputBase`, `NativeSelect`, `OutlinedInput`, `Radio`, `RadioGroup`, `Select`, `SelectInput`, `Switch`, `TextArea`,  and `TextField`.\n\n```diff\nfunction MySelect({ children }) {\n- const handleChange = (event: any, value: string) => {\n+ const handleChange = (event: any, value: unknown) => {\n    // handle value\n  };\n\n  return <Select onChange={handleChange}>{children}</Select>\n}\n```\n\nThis change is explained in more detail in the [TypeScript guide](/guides/typescript/#handling-value-and-event-handlers)\n\n### Buttons（按钮）\n\n- [Button] 删除不推荐使用的按钮变体（flat，raised 和 fab）：\n  \n  ```diff\n  -<Button variant=\"raised\" />\n  +<Button variant=\"contained\" />\n  ```\n  \n  ```diff\n  -<Button variant=\"flat\" />\n  +<Button variant=\"text\" />\n  ```\n  \n  ```diff\n  -import Button from '@material-ui/core/Button';\n  -<Button variant=\"fab\" />\n  +import Fab from '@material-ui/core/Fab';\n  +<Fab />\n  ```\n  \n  ```diff\n  -import Button from '@material-ui/core/Button';\n  -<Button variant=\"extendedFab\" />\n  +import Fab from '@material-ui/core/Fab';\n  +<Fab variant=\"extended\" />\n  ```\n\n- [ButtonBase] 传递给`组件`的属性的组件需要能接受一个 ref。 [组合指南](/guides/composition/#caveat-with-refs)解释了迁移的策略。\n  \n    在 `BottomNavigationAction`，`Button`，`CardActionArea`，`Checkbox`，`ExpansionPanelSummary`，`Fab`，`IconButton`，`MenuItem`，`Radio`，`StepButton`，`Tab`，`TableSortLabel` 以及 `ListItem` 上，若它们的 `button` 属性是 true，则也适用。\n\n### Cards（卡片）\n\n- [CardActions] 将 `disableActionSpacing` 属性重命名为 `disableSpacing`。\n- [CardActions] 移除 CSS类中的 `disableActionSpacing`。\n- [CardActions] 将CSS类 `action` 重命名为 `spacing`。\n\n### ClickAwayListener（他处点击监听器）\n\n- [ClickAwayListener] 隐藏 react-event-listener 的属性。\n\n### Dialog（对话框）\n\n- [DialogActions] 将 `disableActionSpacing` 属性重命名为 `disableSpacing`。\n- [DialogActions] 将CSS类 `action` 重命名为 `spacing`。\n- [DialogContentText] 不使用文字铸排变体 `subtitle1`，而使用 `body1`。\n- [Dialog] 子组件能够接受一个 ref。 [组合指南](/guides/composition/#caveat-with-refs)解释了迁移的策略。\n\n### Dividers（分隔线）\n\n- [Divider] 移除了弃用的 ` inset ` 属性：\n  \n  ```diff\n  -<Divider inset />\n  +<Divider variant=\"inset\" />\n  ```\n\n### ExpansionPanel（扩展面板）\n\n- [ExpansionPanelActions] 将 CSS 类 `action` 重命名为 `spacing`。\n- [ExpansionPanel] Increase the CSS specificity of the `disabled` and `expanded` style rules.\n- [ExpansionPanel] Rename the `CollapseProps` prop to `TransitionProps`.\n\n### Lists（列表）\n\n- [List] 为了符合规范，我们重新在列表组件上做了调整 ：\n  \n  - 当使用头像时，您必须要使用 `ListItemAvatar` 组件。\n  - 当使用左边的复选框时，您必须使用 `ListItemIcon` 组件。\n  - 您必须要在图标按钮上设置 `edge` 属性。\n- [List] `dense` no longer reduces the top and bottom padding of the `List` element.\n\n- [ListItem] 加强 `disabled` 和 `focusVisible` 样式规则的 CSS 特性。\n\n### Menu（菜单）\n\n- [MenuItem] 删除 MenuItem 的固定高度。 浏览器将会自行根据间距和行高来计算高度。\n\n### Modal（模态框）\n\n- [Modal] 子组件能够接受一个 ref。 [组合指南](/guides/composition/#caveat-with-refs)解释了迁移的策略。\n  \n    这也适用于 `Dialog` 和 `Popover` 。\n\n- [Modal] 删除Modal组件类的自定义API (独立使用时将减少-74％的打包大小)。\n\n- [Modal] 现在忽略了 event.defaultPrevented。 即使当向下离开事件调用了 `event.preventDefault()`，新的逻辑也会关闭模态框。 `event.preventDefault()` 旨在禁用一些默认的行为，如单击一个复选框来选中它；点击按钮来提交表单；以及点击左键来移除文本输入框的光标等等。 只有一些特殊的HTML元素才具有这些默认的行为。 若您不想触发模态框的 `onClose` 事件，您需要使用 `event.stopPropagation()`。\n\n### Paper（纸张）\n\n- [Paper] 减小默认的 elevation（阴影高度）。 为了适配卡片组件和扩展面板组件，请更改默认纸张的阴影高度：\n  \n  ```diff\n  -<Paper />\n  +<Paper elevation={2} />\n  ```\n  \n    这也会影响 `扩展面板`。\n\n### Portal（传送门）\n\n- [Portal] 当使用 `disablePortal`属性的时候，子元素需要能够接受一个 ref。 [组合指南](/guides/composition/#caveat-with-refs)解释了迁移的策略。\n\n### Slide（幻灯片）\n\n- [Slide] 子组件能够接受一个 ref。 [组合指南](/guides/composition/#caveat-with-refs)解释了迁移的策略。\n\n### Slider（滑块）\n\n- [Slider] 从 `@material-ui/lab` 迁移到 `@material-ui/core`。\n  \n  ```diff\n  -import Slider from '@material-ui/lab/Slider'\n  +import Slider from '@material-ui/core/Slider'\n  ```\n\n### Switch （开关）\n\n- [Switch] 重新编写实施的代码能够更容易覆盖样式表。 请重命名类的名字以匹配规范的用词：\n  \n  ```diff\n  -icon\n  -bar\n  +thumb\n  +track\n  ```\n\n### Snackbar（消息条）\n\n- [Snackbar] 匹配新的规范。\n  \n  - 更改尺寸。\n  - 将默认的过渡动画从 `Slide` 改成 `Grow`。\n\n### SvgIcon（Svg 图标）\n\n- [SvgIcon] 重命名nativeColor - > htmlColor。 React 在 `for` 这个 HTML 属性上也遇到了同样的问题，他们选择命名这个属性为`htmlFor`。 此变化的原因大同小异。\n  \n  ```diff\n  -<AddIcon nativeColor=\"#fff\" />\n  +<AddIcon htmlColor=\"#fff\" />\n  ```\n\n### Tabs（选项卡）\n\n- [Tab] 为了简单起见，删除了` labelContainer `，`label` 和 `labelWrapped` 等类的 key。 这使得我们可以移走两个中间的 DOM 元素。 您应该可以将自定义的样式移到`根元素`的类的键上。\n  \n    ![一个更简单的标签项的 DOM 结构](https://user-images.githubusercontent.com/3165635/53287870-53a35500-3782-11e9-9431-2d1a14a41be0.png)\n\n- [Tabs] 移除了弃用的 <0>fullWidth</0> 和 <0>scrollable</0> 属性：:\n  \n  ```diff\n  -<Tabs fullWidth scrollable />\n  +<Tabs variant=\"scrollable\" />\n  ```\n\n### Table（表格）\n\n- [TableCell] 移除了弃用的 `numeric` 属性：\n  \n  ```diff\n  -<TableCell numeric>{row.calories}</TableCell>\n  +<TableCell align=\"right\">{row.calories}</TableCell>\n  ```\n\n- [TableRow] 删除了 CSS 属性中的固定高度。 浏览器将会自行根据间距和行高来计算单元格的高度。\n- [TableCell] 将 `dense` 模式移至一个不同的属性：\n  \n  ```diff\n  -<TableCell padding=\"dense\" />\n  +<TableCell size=\"small\" />\n  ```\n\n- [TablePagination] 此组件不再修复无效的属性（`page`，`count`，`rowsPerPage`）组合。 相反的，它会给出一个警告。\n\n### TextField（文本框）\n\n- [InputLabel] 凭借 InputLabel 组件的类 API，您应该可以覆盖 FormLabel 组件所有的样式表。 我们移除了 `FormLabelClasses` 属性。\n  \n  ```diff\n  <InputLabel\n  - FormLabelClasses={{ asterisk: 'bar' }}\n  + classes={{ asterisk: 'bar' }}\n  >\n  Foo\n  </InputLabel>\n  ```\n\n- [InputBase] 改变了默认的盒子模型的大小。 现如今它则使用以下的 CSS：\n  \n  ```css\n  box-sizing: border-box;\n  ```\n  \n    与 `fullWidth` 属性有关的问题迎刃而解。\n\n- [InputBase] 从 `InputBase` 中移走了 `inputType` 类。\n\n### Tooltip（文字提示）\n\n- [Tooltip] 子组件能够接受一个 ref。 [组合指南](/guides/composition/#caveat-with-refs)解释了迁移的策略。\n- [Tooltip] 相比以前任何聚焦都会出现，现在只会在 focus-visible 聚焦的时候出现。\n\n### Typography（文字铸排）\n\n- [Typography] 移除了各种弃用的铸排变体。 您可以通过执行以下的替换来升级： \n  - display4 => h1\n  - display3 => h2\n  - display2 => h3\n  - display1 => h4\n  - headline => h5\n  - title => h6\n  - subheading => subtitle1\n  - body2 => body1\n  - body1 (default) => body2 (default)\n- [Typography] 移除了固定的 `display: block` 这个默认的铸排样式。 您现在可以使用新的 `display?: 'initial' | 'inline' | 'block';` 属性。\n- [Typography] 为了达到更好的排版效果，请重命名属性 `headlineMapping` 为 `variantMapping`。\n  \n  ```diff\n  -<Typography headlineMapping={headlineMapping}>\n  +<Typography variantMapping={variantMapping}>\n  ```\n\n- [Typography] 将默认的字体从 `body2` 换成 `body1`。 默认为16px的字体大小比默认为14px好。 Bootstrap, material.io, and even the documentation use 16px as a default font size. 像 Ant Design 一样使用14px是可以理解的，因为中国的用户使用了不同的字母表。 12px is recommended as the default font size for Japanese.\n- [Typography] 移除了铸排变体的默认颜色。 大多数情况下，字体颜色应该是继承而来的。 这是网站的默认行为。\n- [Typography] Rename `color=\"default\"` to `color=\"initial\"` following the logic of [this thread](https://github.com/Foso/material-ui/issues/13028). 您不应该再使用 *default*，它缺少明确的语义。\n\n### Node\n\n- [是时候放弃对 node 6 的支持](https://github.com/nodejs/Release/blob/eb91c94681ea968a69bf4a4fe85c656ed44263b3/README.md#release-schedule)，而升级到 node 8 啦。\n\n### UMD\n\n- 此更改简化了 Material-UI 与 CDN 的使用：\n  \n  ```diff\n  const {\n    Button,\n    TextField,\n  -} = window['material-ui'];\n  +} = MaterialUI;\n  ```\n  \n    它与其他 React 的项目保持一致：\n  \n  - material-ui => MaterialUI\n  - react-dom => ReactDOM\n  - prop-types => PropTypes\n"