{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport LZString from 'lz-string';\nimport clsx from 'clsx';\nimport copy from 'clipboard-copy';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { withStyles, fade } from \"../../../../packages/material-ui/src/styles\";\nimport IconButton from \"../../../../packages/material-ui/src/IconButton\";\nimport useMediaQuery from \"../../../../packages/material-ui/src/useMediaQuery\";\nimport Collapse from \"../../../../packages/material-ui/src/Collapse\";\nimport NoSsr from \"../../../../packages/material-ui/src/NoSsr\";\nimport EditIcon from \"../../../../packages/material-ui-icons/src/Edit\";\nimport CodeIcon from \"../../../../packages/material-ui-icons/src/Code\";\nimport FileCopyIcon from \"../../../../packages/material-ui-icons/src/FileCopy\";\nimport Snackbar from \"../../../../packages/material-ui/src/Snackbar\";\nimport Menu from \"../../../../packages/material-ui/src/Menu\";\nimport MenuItem from \"../../../../packages/material-ui/src/MenuItem\";\nimport MoreVertIcon from \"../../../../packages/material-ui-icons/src/MoreVert\";\nimport Tooltip from \"../../../../packages/material-ui/src/Tooltip\";\nimport MarkdownElement from \"./MarkdownElement\";\nimport DemoSandboxed from \"./DemoSandboxed\";\nimport DemoLanguages from \"./DemoLanguages\";\nimport getDemoConfig from \"../utils/getDemoConfig\";\nimport getJsxPreview from \"../utils/getJsxPreview\";\nimport { getCookie } from \"../utils/helpers\";\nimport { ACTION_TYPES, CODE_VARIANTS } from \"../constants\";\n\nfunction compress(object) {\n  return LZString.compressToBase64(_JSON$stringify(object)).replace(/\\+/g, '-') // Convert '+' to '-'\n  .replace(/\\//g, '_') // Convert '/' to '_'\n  .replace(/=+$/, ''); // Remove ending '='\n}\n\nfunction addHiddenInput(form, name, value) {\n  var input = document.createElement('input');\n  input.type = 'hidden';\n  input.name = name;\n  input.value = value;\n  form.appendChild(input);\n}\n\nvar styles = function styles(theme) {\n  var _header, _code;\n\n  return {\n    root: _defineProperty({\n      marginBottom: 40,\n      marginLeft: -theme.spacing(2),\n      marginRight: -theme.spacing(2)\n    }, theme.breakpoints.up('sm'), {\n      padding: theme.spacing(0, 1),\n      marginLeft: 0,\n      marginRight: 0\n    }),\n    demo: _defineProperty({\n      position: 'relative',\n      outline: 0,\n      margin: 'auto',\n      display: 'flex',\n      justifyContent: 'center'\n    }, theme.breakpoints.up('sm'), {\n      borderRadius: theme.shape.borderRadius\n    }),\n\n    /* Isolate the demo with an outline. */\n    demoBgOutlined: _defineProperty({\n      padding: theme.spacing(3),\n      border: \"1px solid \".concat(fade(theme.palette.action.active, 0.12)),\n      borderLeftWidth: 0,\n      borderRightWidth: 0\n    }, theme.breakpoints.up('sm'), {\n      borderLeftWidth: 1,\n      borderRightWidth: 1\n    }),\n\n    /* Prepare the background to display an inner elevation. */\n    demoBgTrue: {\n      padding: theme.spacing(3),\n      backgroundColor: theme.palette.background.level2\n    },\n\n    /* Make no difference between the demo and the markdown. */\n    demoBgInline: _defineProperty({}, theme.breakpoints.down('xs'), {\n      padding: theme.spacing(3)\n    }),\n    demoHiddenHeader: _defineProperty({\n      paddingTop: theme.spacing(2)\n    }, theme.breakpoints.up('sm'), {\n      paddingTop: theme.spacing(3)\n    }),\n    header: (_header = {\n      display: 'none'\n    }, _defineProperty(_header, theme.breakpoints.up('sm'), {\n      display: 'flex',\n      flip: false,\n      top: 0,\n      right: theme.spacing(1),\n      height: theme.spacing(6)\n    }), _defineProperty(_header, \"justifyContent\", 'space-between'), _header),\n    headerButtons: {\n      margin: '2px 0'\n    },\n    code: (_code = {\n      display: 'none',\n      padding: 0,\n      marginBottom: theme.spacing(1),\n      marginRight: 0\n    }, _defineProperty(_code, theme.breakpoints.up('sm'), {\n      display: 'block'\n    }), _defineProperty(_code, '& pre', {\n      overflow: 'auto',\n      lineHeight: 1.5,\n      margin: '0px !important',\n      maxHeight: 1000\n    }), _code),\n    tooltip: {\n      zIndex: theme.zIndex.appBar - 1\n    },\n    anchorLink: {\n      marginTop: -64,\n      // height of toolbar\n      position: 'absolute'\n    }\n  };\n};\n\nfunction getDemoName(location) {\n  return location.replace(/(.+?)(\\w+)\\.\\w+$$/, '$2');\n}\n\nfunction getDemoData(codeVariant, demo, githubLocation) {\n  if (codeVariant === CODE_VARIANTS.TS && demo.rawTS) {\n    return {\n      codeVariant: CODE_VARIANTS.TS,\n      githubLocation: githubLocation.replace(/\\.js$/, '.tsx'),\n      raw: demo.rawTS,\n      Component: demo.tsx,\n      sourceLanguage: 'tsx'\n    };\n  }\n\n  return {\n    codeVariant: CODE_VARIANTS.JS,\n    githubLocation: githubLocation,\n    raw: demo.raw,\n    Component: demo.js,\n    sourceLanguage: 'jsx'\n  };\n}\n\nvar _ref3 = __jsx(CodeIcon, {\n  fontSize: \"small\"\n});\n\nvar _ref4 = __jsx(EditIcon, {\n  fontSize: \"small\"\n});\n\nvar _ref5 = __jsx(FileCopyIcon, {\n  fontSize: \"small\"\n});\n\nvar _ref6 = __jsx(MoreVertIcon, {\n  fontSize: \"small\"\n});\n\nfunction Demo(props) {\n  var classes = props.classes,\n      demo = props.demo,\n      demoOptions = props.demoOptions,\n      githubLocation = props.githubLocation;\n  var dispatch = useDispatch();\n  var t = useSelector(function (state) {\n    return state.options.t;\n  });\n  var codeVariant = useSelector(function (state) {\n    return state.options.codeVariant;\n  });\n  var demoData = getDemoData(codeVariant, demo, githubLocation);\n\n  var _React$useState = React.useState(false),\n      sourceHintSeen = _React$useState[0],\n      setSourceHintSeen = _React$useState[1];\n\n  React.useEffect(function () {\n    setSourceHintSeen(getCookie('sourceHintSeen'));\n  }, []);\n\n  var _React$useState2 = React.useState(false),\n      demoHovered = _React$useState2[0],\n      setDemoHovered = _React$useState2[1];\n\n  var handleDemoHover = function handleDemoHover(event) {\n    setDemoHovered(event.type === 'mouseenter');\n  };\n\n  var _React$useState3 = React.useState(false),\n      snackbarOpen = _React$useState3[0],\n      setSnackbarOpen = _React$useState3[1];\n\n  var _React$useState4 = React.useState(undefined),\n      snackbarMessage = _React$useState4[0],\n      setSnackbarMessage = _React$useState4[1];\n\n  var handleSnackbarClose = function handleSnackbarClose() {\n    setSnackbarOpen(false);\n  };\n\n  var handleCodeLanguageClick = function handleCodeLanguageClick(event, clickedCodeVariant) {\n    if (codeVariant !== clickedCodeVariant) {\n      dispatch({\n        type: ACTION_TYPES.OPTIONS_CHANGE,\n        payload: {\n          codeVariant: clickedCodeVariant\n        }\n      });\n    }\n  };\n\n  var handleCodeSandboxClick = function handleCodeSandboxClick() {\n    var demoConfig = getDemoConfig(demoData);\n    var parameters = compress({\n      files: _objectSpread({\n        'package.json': {\n          content: {\n            title: demoConfig.title,\n            description: demoConfig.description,\n            dependencies: demoConfig.dependencies,\n            devDependencies: _objectSpread({\n              'react-scripts': 'latest'\n            }, demoConfig.devDependencies),\n            main: demoConfig.main,\n            scripts: demoConfig.scripts\n          }\n        }\n      }, _Object$keys(demoConfig.files).reduce(function (files, name) {\n        files[name] = {\n          content: demoConfig.files[name]\n        };\n        return files;\n      }, {}))\n    });\n    var form = document.createElement('form');\n    form.method = 'POST';\n    form.target = '_blank';\n    form.action = 'https://codeSandbox.io/api/v1/sandboxes/define';\n    addHiddenInput(form, 'parameters', parameters);\n    document.body.appendChild(form);\n    form.submit();\n    document.body.removeChild(form);\n  };\n\n  var _React$useState5 = React.useState(null),\n      anchorEl = _React$useState5[0],\n      setAnchorEl = _React$useState5[1];\n\n  var handleMoreClick = function handleMoreClick(event) {\n    setAnchorEl(event.currentTarget);\n  };\n\n  var handleMoreClose = function handleMoreClose() {\n    setAnchorEl(null);\n  };\n\n  var handleCopyClick = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return copy(demoData.raw);\n\n            case 3:\n              setSnackbarMessage(t('copiedSource'));\n              setSnackbarOpen(true);\n\n            case 5:\n              _context.prev = 5;\n              handleMoreClose();\n              return _context.finish(5);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0,, 5, 8]]);\n    }));\n\n    return function handleCopyClick() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleStackBlitzClick = function handleStackBlitzClick() {\n    var demoConfig = getDemoConfig(demoData);\n    var form = document.createElement('form');\n    form.method = 'POST';\n    form.target = '_blank';\n    form.action = 'https://stackblitz.com/run';\n    addHiddenInput(form, 'project[template]', 'javascript');\n    addHiddenInput(form, 'project[title]', demoConfig.title);\n    addHiddenInput(form, 'project[description]', demoConfig.description);\n    addHiddenInput(form, 'project[dependencies]', _JSON$stringify(demoConfig.dependencies));\n    addHiddenInput(form, 'project[devDependencies]', _JSON$stringify(demoConfig.devDependencies));\n\n    _Object$keys(demoConfig.files).forEach(function (key) {\n      var value = demoConfig.files[key];\n      addHiddenInput(form, \"project[files][\".concat(key, \"]\"), value);\n    });\n\n    document.body.appendChild(form);\n    form.submit();\n    document.body.removeChild(form);\n    handleMoreClose();\n  };\n\n  var showSourceHint = demoHovered && !sourceHintSeen;\n  var DemoComponent = demoData.Component;\n  var demoName = getDemoName(demoData.githubLocation);\n  var demoSandboxedStyle = React.useMemo(function () {\n    return {\n      maxWidth: demoOptions.maxWidth,\n      height: demoOptions.height\n    };\n  }, [demoOptions.height, demoOptions.maxWidth]);\n\n  if (demoOptions.bg == null) {\n    demoOptions.bg = 'outlined';\n  }\n\n  if (demoOptions.iframe) {\n    demoOptions.bg = true;\n  }\n\n  var createHandleCodeSourceLink = function createHandleCodeSourceLink(anchor) {\n    return (/*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return copy(\"\".concat(window.location.href.split('#')[0], \"#\").concat(anchor));\n\n              case 3:\n                setSnackbarMessage(t('copiedSourceLink'));\n                setSnackbarOpen(true);\n\n              case 5:\n                _context2.prev = 5;\n                handleMoreClose();\n                return _context2.finish(5);\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0,, 5, 8]]);\n      }))\n    );\n  };\n\n  var _React$useState6 = React.useState(demoOptions.defaultCodeOpen || false),\n      codeOpen = _React$useState6[0],\n      setCodeOpen = _React$useState6[1];\n\n  React.useEffect(function () {\n    var navigatedDemoName = getDemoName(window.location.hash);\n\n    if (demoName === navigatedDemoName) {\n      setCodeOpen(true);\n    }\n  }, [demoName]);\n\n  var handleCodeOpenClick = function handleCodeOpenClick() {\n    document.cookie = \"sourceHintSeen=true;path=/;max-age=31536000\";\n    setCodeOpen(function (open) {\n      return !open;\n    });\n    setSourceHintSeen(setSourceHintSeen(true));\n  };\n\n  var match = useMediaQuery(function (theme) {\n    return theme.breakpoints.up('sm');\n  });\n  var jsx = getJsxPreview(demoData.raw || '');\n  var showPreview = !demoOptions.hideHeader && demoOptions.defaultCodeOpen !== false && jsx !== demoData.raw && jsx.split(/\\n/).length <= 17;\n  var showCodeLabel;\n\n  if (codeOpen) {\n    showCodeLabel = showPreview ? t('hideFullSource') : t('hideSource');\n  } else {\n    showCodeLabel = showPreview ? t('showFullSource') : t('showSource');\n  }\n\n  return __jsx(\"div\", {\n    className: classes.root\n  }, __jsx(\"div\", {\n    className: clsx(classes.demo, {\n      'outlined': classes.demoBgOutlined,\n      'inline': classes.demoBgInline\n    }[demoOptions.bg], demoOptions.hideHeader && classes.demoHiddenHeader, demoOptions.bg === true && classes.demoBgTrue),\n    tabIndex: -1,\n    onMouseEnter: handleDemoHover,\n    onMouseLeave: handleDemoHover\n  }, __jsx(DemoSandboxed, {\n    style: demoSandboxedStyle,\n    component: DemoComponent,\n    iframe: demoOptions.iframe,\n    name: demoName\n  })), __jsx(\"div\", {\n    className: classes.anchorLink,\n    id: \"\".concat(demoName, \".js\")\n  }), __jsx(\"div\", {\n    className: classes.anchorLink,\n    id: \"\".concat(demoName, \".tsx\")\n  }), demoOptions.hideHeader ? null : __jsx(\"div\", {\n    className: classes.header\n  }, __jsx(NoSsr, null, __jsx(DemoLanguages, {\n    demo: demo,\n    codeOpen: codeOpen,\n    codeVariant: codeVariant,\n    gaEventLabel: demoOptions.demo,\n    onLanguageClick: handleCodeLanguageClick\n  }), __jsx(\"div\", {\n    className: classes.headerButtons\n  }, __jsx(Tooltip, {\n    classes: {\n      popper: classes.tooltip\n    },\n    key: showSourceHint,\n    open: showSourceHint && match ? true : undefined,\n    PopperProps: {\n      disablePortal: true\n    },\n    title: showCodeLabel,\n    placement: \"top\"\n  }, __jsx(IconButton, {\n    \"aria-label\": showCodeLabel,\n    \"data-ga-event-category\": \"demo\",\n    \"data-ga-event-label\": demoOptions.demo,\n    \"data-ga-event-action\": \"expand\",\n    onClick: handleCodeOpenClick,\n    color: demoHovered ? 'primary' : 'default'\n  }, _ref3)), demoOptions.hideEditButton ? null : __jsx(Tooltip, {\n    classes: {\n      popper: classes.tooltip\n    },\n    title: t('codesandbox'),\n    placement: \"top\"\n  }, __jsx(IconButton, {\n    \"aria-label\": t('codesandbox'),\n    \"data-ga-event-category\": \"demo\",\n    \"data-ga-event-label\": demoOptions.demo,\n    \"data-ga-event-action\": \"codesandbox\",\n    onClick: handleCodeSandboxClick\n  }, _ref4)), __jsx(Tooltip, {\n    classes: {\n      popper: classes.tooltip\n    },\n    title: t('copySource'),\n    placement: \"top\"\n  }, __jsx(IconButton, {\n    \"aria-label\": t('copySource'),\n    \"data-ga-event-category\": \"demo\",\n    \"data-ga-event-label\": demoOptions.demo,\n    \"data-ga-event-action\": \"copy\",\n    onClick: handleCopyClick\n  }, _ref5)), __jsx(IconButton, {\n    onClick: handleMoreClick,\n    \"aria-owns\": anchorEl ? 'demo-menu-more' : undefined,\n    \"aria-haspopup\": \"true\",\n    \"aria-label\": t('seeMore')\n  }, _ref6), __jsx(Menu, {\n    id: \"demo-menu-more\",\n    anchorEl: anchorEl,\n    open: Boolean(anchorEl),\n    onClose: handleMoreClose,\n    getContentAnchorEl: null,\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    }\n  }, __jsx(MenuItem, {\n    \"data-ga-event-category\": \"demo\",\n    \"data-ga-event-label\": demoOptions.demo,\n    \"data-ga-event-action\": \"github\",\n    component: \"a\",\n    href: demoData.githubLocation,\n    target: \"_blank\",\n    rel: \"noopener nofollow\",\n    onClick: handleMoreClose\n  }, t('viewGitHub')), demoOptions.hideEditButton ? null : __jsx(MenuItem, {\n    \"data-ga-event-category\": \"demo\",\n    \"data-ga-event-label\": demoOptions.demo,\n    \"data-ga-event-action\": \"stackblitz\",\n    onClick: handleStackBlitzClick\n  }, t('stackblitz')), __jsx(MenuItem, {\n    \"data-ga-event-category\": \"demo\",\n    \"data-ga-event-label\": demoOptions.demo,\n    \"data-ga-event-action\": \"copy-js-source-link\",\n    onClick: createHandleCodeSourceLink(\"\".concat(demoName, \".js\"))\n  }, t('copySourceLinkJS')), __jsx(MenuItem, {\n    \"data-ga-event-category\": \"demo\",\n    \"data-ga-event-label\": demoOptions.demo,\n    \"data-ga-event-action\": \"copy-ts-source-link\",\n    onClick: createHandleCodeSourceLink(\"\".concat(demoName, \".tsx\"))\n  }, t('copySourceLinkTS')))))), __jsx(Collapse, {\n    in: codeOpen || showPreview,\n    unmountOnExit: true\n  }, __jsx(MarkdownElement, {\n    className: classes.code,\n    text: \"```\".concat(demoData.sourceLanguage, \"\\n\").concat(codeOpen ? demoData.raw : jsx, \"\\n```\")\n  })), __jsx(Snackbar, {\n    open: snackbarOpen,\n    autoHideDuration: 3000,\n    onClose: handleSnackbarClose,\n    message: snackbarMessage\n  }));\n}\n\nexport default withStyles(styles)(Demo);","map":null,"metadata":{},"sourceType":"module"}