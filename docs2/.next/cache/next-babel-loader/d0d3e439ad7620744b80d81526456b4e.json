{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nvar __jsx = React.createElement;\n/* eslint-disable no-underscore-dangle */\n\nimport \"../src/modules/components/bootstrap\"; // --- Post bootstrap -----\n\nimport React from 'react';\nimport App from 'next/app';\nimport find from 'lodash/find';\nimport { Provider as ReduxProvider, useDispatch, useSelector } from 'react-redux';\nimport { loadCSS } from 'fg-loadcss/src/loadCSS';\nimport NextHead from 'next/head';\nimport acceptLanguage from 'accept-language';\nimport { create } from 'jss';\nimport rtl from 'jss-rtl';\nimport { Router as Router2, useRouter } from 'next/router';\nimport { StylesProvider, jssPreset } from \"../../packages/material-ui-styles/src\";\nimport pages from \"../src/pages\";\nimport initRedux from \"../src/modules/redux/initRedux\";\nimport PageContext from \"../src/modules/components/PageContext\";\nimport GoogleAnalytics from \"../src/modules/components/GoogleAnalytics\";\nimport loadScript from \"../src/modules/utils/loadScript\";\nimport { ThemeProvider } from \"../src/modules/components/ThemeContext\";\nimport { pathnameToLanguage, getCookie } from \"../src/modules/utils/helpers\";\nimport { ACTION_TYPES, CODE_VARIANTS } from \"../src/modules/constants\"; // Configure JSS\n\nvar jss = create({\n  plugins: [].concat(_toConsumableArray(jssPreset().plugins), [rtl()]),\n  insertionPoint: process.browser ? document.querySelector('#insertion-point-jss') : null\n});\n\nfunction useFirstRender() {\n  var firstRenderRef = React.useRef(true);\n  React.useEffect(function () {\n    firstRenderRef.current = false;\n  }, []);\n  return firstRenderRef.current;\n}\n\nacceptLanguage.languages(['en', 'zh']);\n\nfunction loadCrowdin() {\n  window._jipt = [];\n\n  window._jipt.push(['project', 'material-ui-docs']);\n\n  loadScript('https://cdn.crowdin.com/jipt/jipt.js', document.querySelector('head'));\n}\n\nfunction LanguageNegotiation() {\n  var dispatch = useDispatch();\n  var router = useRouter();\n  var userLanguage = useSelector(function (state) {\n    return state.options.userLanguage;\n  });\n  React.useEffect(function () {\n    if (userLanguage === 'aa') {\n      loadCrowdin();\n    }\n  }, [userLanguage]);\n  React.useEffect(function () {\n    var _pathnameToLanguage = pathnameToLanguage(Router2._rewriteUrlForNextExport(router.asPath)),\n        userLanguageUrl = _pathnameToLanguage.userLanguage,\n        canonical = _pathnameToLanguage.canonical;\n\n    var preferedLanguage = getCookie('userLanguage') !== 'noDefault' && userLanguage === 'en' ? acceptLanguage.get(navigator.language) : userLanguage;\n\n    if (preferedLanguage !== userLanguage) {\n      window.location = preferedLanguage === 'en' ? canonical : \"/\".concat(preferedLanguage).concat(canonical);\n    } else if (userLanguageUrl !== userLanguage) {\n      dispatch({\n        type: ACTION_TYPES.OPTIONS_CHANGE,\n        payload: {\n          userLanguage: userLanguageUrl\n        }\n      });\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return null;\n}\n/**\n * Priority: on first render: navigated value, persisted value; otherwise initial value, 'JS'\n * @param {string} initialCodeVariant\n * @param {(nextCodeVariant: string) => void} codeVariantChanged\n * @returns {string} - The persisted variant if the initial value is undefined\n */\n\n\nfunction usePersistCodeVariant() {\n  var initialCodeVariant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : CODE_VARIANTS.JS;\n  var codeVariantChanged = arguments.length > 1 ? arguments[1] : undefined;\n  var isFirstRender = useFirstRender();\n  var navigatedCodeVariant = React.useMemo(function () {\n    var navigatedCodeVariantMatch = true ? window.location.hash.match(/\\.(js|tsx)$/) : null;\n\n    if (navigatedCodeVariantMatch === null) {\n      return undefined;\n    }\n\n    return navigatedCodeVariantMatch[1] === 'tsx' ? CODE_VARIANTS.TS : CODE_VARIANTS.JS;\n  }, []);\n  var persistedCodeVariant = React.useMemo(function () {\n    if (false) {\n      return undefined;\n    }\n\n    return getCookie('codeVariant');\n  }, []);\n  /**\n   * we initialize from navigation or cookies. on subsequent renders the store is the\n   * truth\n   */\n\n  var codeVariant = isFirstRender === true ? navigatedCodeVariant || persistedCodeVariant || initialCodeVariant : initialCodeVariant;\n  React.useEffect(function () {\n    if (codeVariant !== initialCodeVariant) {\n      codeVariantChanged(codeVariant);\n    }\n  });\n  React.useEffect(function () {\n    document.cookie = \"codeVariant=\".concat(codeVariant, \";path=/;max-age=31536000\");\n  }, [codeVariant]);\n  return codeVariant;\n}\n\nfunction PersistState() {\n  var dispatch = useDispatch();\n  var options = useSelector(function (state) {\n    return state.options;\n  });\n  var codeVariant = usePersistCodeVariant(options.codeVariant, function (nextCodeVariant) {\n    return dispatch({\n      type: ACTION_TYPES.OPTIONS_CHANGE,\n      payload: {\n        codeVariant: nextCodeVariant\n      }\n    });\n  });\n  React.useEffect(function () {\n    window.ga('set', 'dimension1', codeVariant);\n  }, [codeVariant]);\n  React.useEffect(function () {\n    window.ga('set', 'dimension2', options.userLanguage);\n  }, [options.userLanguage]);\n  return null;\n} // Inspired by\n// https://developers.google.com/web/tools/workbox/guides/advanced-recipes#offer_a_page_reload_for_users\n\n\nfunction forcePageReload(registration) {\n  // console.log('already controlled?', Boolean(navigator.serviceWorker.controller));\n  if (!navigator.serviceWorker.controller) {\n    // The window client isn't currently controlled so it's a new service\n    // worker that will activate immediately.\n    return;\n  } // console.log('registration waiting?', Boolean(registration.waiting));\n\n\n  if (registration.waiting) {\n    // SW is waiting to activate. Can occur if multiple clients open and\n    // one of the clients is refreshed.\n    registration.waiting.postMessage('skipWaiting');\n    return;\n  }\n\n  function listenInstalledStateChange() {\n    registration.installing.addEventListener('statechange', function (event) {\n      // console.log('statechange', event.target.state);\n      if (event.target.state === 'installed' && registration.waiting) {\n        // A new service worker is available, inform the user\n        registration.waiting.postMessage('skipWaiting');\n      } else if (event.target.state === 'activated') {\n        // Force the control of the page by the activated service worker.\n        window.location.reload();\n      }\n    });\n  }\n\n  if (registration.installing) {\n    listenInstalledStateChange();\n    return;\n  } // We are currently controlled so a new SW may be found...\n  // Add a listener in case a new SW is found,\n\n\n  registration.addEventListener('updatefound', listenInstalledStateChange);\n}\n\nfunction registerServiceWorker() {\n  return _registerServiceWorker.apply(this, arguments);\n} // Add the strict mode back once the number of warnings is manageable.\n// We might miss important warnings by keeping the strict mode ðŸŒŠðŸŒŠðŸŒŠ.\n\n\nfunction _registerServiceWorker() {\n  _registerServiceWorker = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var registration;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!('serviceWorker' in navigator && process.env.NODE_ENV === 'production' && window.location.host.indexOf('material-ui.com') <= 0)) {\n              _context2.next = 5;\n              break;\n            }\n\n            _context2.next = 3;\n            return navigator.serviceWorker.register('/sw.js');\n\n          case 3:\n            registration = _context2.sent; // Force the page reload for users.\n\n            forcePageReload(registration);\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _registerServiceWorker.apply(this, arguments);\n}\n\nvar ReactMode = {\n  // createSyncRoot compatible\n  sync: React.StrictMode,\n  // partial createRoot, ConcurrentMode is deprecated\n  concurrent: React.unstable_ConcurrentMode\n}[process.env.REACT_MODE] || React.Fragment;\nvar dependenciesLoaded = false;\n\nfunction loadDependencies() {\n  if (dependenciesLoaded) {\n    return;\n  }\n\n  dependenciesLoaded = true;\n  loadCSS('https://fonts.googleapis.com/icon?family=Material+Icons', document.querySelector('#material-icon-font'));\n  loadScript('https://www.google-analytics.com/analytics.js', document.querySelector('head'));\n}\n\nif (process.browser && process.env.NODE_ENV === 'production') {\n  // eslint-disable-next-line no-console\n  console.log(\"%c\\n\\n\\u2588\\u2588\\u2588\\u2557   \\u2588\\u2588\\u2588\\u2557 \\u2588\\u2588\\u2588\\u2588\\u2588\\u2557 \\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2557\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2557\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2557 \\u2588\\u2588\\u2557 \\u2588\\u2588\\u2588\\u2588\\u2588\\u2557 \\u2588\\u2588\\u2557      \\u2588\\u2588\\u2557   \\u2588\\u2588\\u2557\\u2588\\u2588\\u2557\\n\\u2588\\u2588\\u2588\\u2588\\u2557 \\u2588\\u2588\\u2588\\u2588\\u2551\\u2588\\u2588\\u2554\\u2550\\u2550\\u2588\\u2588\\u2557\\u255A\\u2550\\u2550\\u2588\\u2588\\u2554\\u2550\\u2550\\u255D\\u2588\\u2588\\u2554\\u2550\\u2550\\u2550\\u2550\\u255D\\u2588\\u2588\\u2554\\u2550\\u2550\\u2588\\u2588\\u2557\\u2588\\u2588\\u2551\\u2588\\u2588\\u2554\\u2550\\u2550\\u2588\\u2588\\u2557\\u2588\\u2588\\u2551      \\u2588\\u2588\\u2551   \\u2588\\u2588\\u2551\\u2588\\u2588\\u2551\\n\\u2588\\u2588\\u2554\\u2588\\u2588\\u2588\\u2588\\u2554\\u2588\\u2588\\u2551\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2551   \\u2588\\u2588\\u2551   \\u2588\\u2588\\u2588\\u2588\\u2588\\u2557  \\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2554\\u255D\\u2588\\u2588\\u2551\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2551\\u2588\\u2588\\u2551\\u2588\\u2588\\u2588\\u2588\\u2588\\u2557\\u2588\\u2588\\u2551   \\u2588\\u2588\\u2551\\u2588\\u2588\\u2551\\n\\u2588\\u2588\\u2551\\u255A\\u2588\\u2588\\u2554\\u255D\\u2588\\u2588\\u2551\\u2588\\u2588\\u2554\\u2550\\u2550\\u2588\\u2588\\u2551   \\u2588\\u2588\\u2551   \\u2588\\u2588\\u2554\\u2550\\u2550\\u255D  \\u2588\\u2588\\u2554\\u2550\\u2550\\u2588\\u2588\\u2557\\u2588\\u2588\\u2551\\u2588\\u2588\\u2554\\u2550\\u2550\\u2588\\u2588\\u2551\\u2588\\u2588\\u2551\\u255A\\u2550\\u2550\\u2550\\u2550\\u255D\\u2588\\u2588\\u2551   \\u2588\\u2588\\u2551\\u2588\\u2588\\u2551\\n\\u2588\\u2588\\u2551 \\u255A\\u2550\\u255D \\u2588\\u2588\\u2551\\u2588\\u2588\\u2551  \\u2588\\u2588\\u2551   \\u2588\\u2588\\u2551   \\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2557\\u2588\\u2588\\u2551  \\u2588\\u2588\\u2551\\u2588\\u2588\\u2551\\u2588\\u2588\\u2551  \\u2588\\u2588\\u2551\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2557 \\u255A\\u2588\\u2588\\u2588\\u2588\\u2588\\u2588\\u2554\\u255D\\u2588\\u2588\\u2551\\n\\u255A\\u2550\\u255D     \\u255A\\u2550\\u255D\\u255A\\u2550\\u255D  \\u255A\\u2550\\u255D   \\u255A\\u2550\\u255D   \\u255A\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u255D\\u255A\\u2550\\u255D  \\u255A\\u2550\\u255D\\u255A\\u2550\\u255D\\u255A\\u2550\\u255D  \\u255A\\u2550\\u255D\\u255A\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u255D  \\u255A\\u2550\\u2550\\u2550\\u2550\\u2550\\u255D \\u255A\\u2550\\u255D\\n\\nTip: you can access the documentation `theme` object directly in the console.\\n\", 'font-family:monospace;color:#1976d2;font-size:12px;');\n}\n\nfunction findActivePage(currentPages, pathname) {\n  var activePage = find(currentPages, function (page) {\n    if (page.children) {\n      if (pathname.indexOf(\"\".concat(page.pathname, \"/\")) === 0) {\n        // Check if one of the children matches (for /components)\n        return findActivePage(page.children, pathname);\n      }\n    } // Should be an exact match if no children\n\n\n    return pathname === page.pathname;\n  });\n\n  if (!activePage) {\n    return null;\n  } // We need to drill down\n\n\n  if (activePage.pathname !== pathname) {\n    return findActivePage(activePage.children, pathname);\n  }\n\n  return activePage;\n}\n\nvar _ref = __jsx(PersistState, null);\n\nvar _ref2 = __jsx(LanguageNegotiation, null);\n\nfunction AppWrapper(props) {\n  var children = props.children,\n      pageProps = props.pageProps;\n  var router = useRouter();\n\n  var _React$useState = React.useState(function () {\n    return initRedux(pageProps.reduxServerState);\n  }),\n      redux = _React$useState[0];\n\n  React.useEffect(function () {\n    loadDependencies();\n    registerServiceWorker(); // Remove the server-side injected CSS.\n\n    var jssStyles = document.querySelector('#jss-server-side');\n\n    if (jssStyles) {\n      jssStyles.parentElement.removeChild(jssStyles);\n    }\n  }, []);\n  var pathname = router.pathname; // Add support for leading / in development mode.\n\n  if (pathname !== '/') {\n    // The leading / is only added to support static hosting (resolve /index.html).\n    // We remove it to normalize the pathname.\n    // See `_rewriteUrlForNextExport` on Next.js side.\n    pathname = pathname.replace(/\\/$/, '');\n  }\n\n  var activePage = findActivePage(pages, pathname);\n  var fonts = ['https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap'];\n\n  if (pathname.match(/onepirate/)) {\n    fonts = ['https://fonts.googleapis.com/css?family=Roboto+Condensed:700|Work+Sans:300,400&display=swap'];\n  }\n\n  return __jsx(ReactMode, null, __jsx(NextHead, null, fonts.map(function (font) {\n    return __jsx(\"link\", {\n      rel: \"stylesheet\",\n      href: font,\n      key: font\n    });\n  })), __jsx(ReduxProvider, {\n    store: redux\n  }, __jsx(PageContext.Provider, {\n    value: {\n      activePage: activePage,\n      pages: pages,\n      versions: pageProps.versions\n    }\n  }, __jsx(StylesProvider, {\n    jss: jss\n  }, __jsx(ThemeProvider, null, children))), _ref, _ref2), __jsx(GoogleAnalytics, {\n    key: router.route\n  }));\n}\n\nvar MyApp = /*#__PURE__*/function (_App) {\n  _inherits(MyApp, _App);\n\n  function MyApp() {\n    _classCallCheck(this, MyApp);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(MyApp).apply(this, arguments));\n  }\n\n  _createClass(MyApp, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          pageProps = _this$props.pageProps;\n      return __jsx(AppWrapper, {\n        pageProps: pageProps\n      }, __jsx(Component, pageProps));\n    }\n  }]);\n\n  return MyApp;\n}(App);\n\nexport { MyApp as default };\n\nMyApp.getInitialProps = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref4) {\n    var ctx, Component, pageProps, redux;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            ctx = _ref4.ctx, Component = _ref4.Component;\n            pageProps = {};\n\n            if (!Component.getInitialProps) {\n              _context.next = 6;\n              break;\n            }\n\n            _context.next = 5;\n            return Component.getInitialProps(ctx);\n\n          case 5:\n            pageProps = _context.sent;\n\n          case 6:\n            if (!process.browser) {\n              redux = initRedux({\n                options: {\n                  userLanguage: ctx.query.userLanguage\n                }\n              });\n              pageProps = _objectSpread({}, pageProps, {\n                // No need to include other initial Redux state because when it\n                // initialises on the client-side it'll create it again anyway\n                reduxServerState: redux.getState()\n              });\n            }\n\n            return _context.abrupt(\"return\", {\n              pageProps: pageProps\n            });\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();","map":null,"metadata":{},"sourceType":"module"}